%% l = 64
randn = [1.473417e6, 2.0504833e7, 4.5409792e7, 8.3414042e7, 1.57467167e8, 3.34441334e8, 6.98842416e8, 2.411631709e9, 4.586853875e9, 2.0778278708e10];
srft = [6.017125e6, 1.2269959e7, 2.3910916e7, 4.8128792e7, 1.13692417e8, 2.15223458e8, 4.15670375e8, 9.46019084e8, 1.3492141292e10, 3.1257130583e10];
sub = [1.341666e6, 771333.0, 789666.0, 811667.0, 892041.0, 1.6159958e7, 2.4527167e7, 3.0881e7, 1.2165738667e10, 3.1399737167e10];
l = 64; n = 1000; zeta = 8;
ms = [1024, 2048, 4096, 8192, 16384, 32768, 65536, 131072, 262144, 524288];
%%
markers = {'ro','gs','bd','c^','mv','y>','<','p','h','+','*','x'};

subplot(1,3,1)
loglog(ms, randn/1e9, strcat(markers{1},'-'), 'LineWidth', 1.5)
hold on
plot(ms, srft/1e9, strcat(markers{2},'-'), 'LineWidth', 1.5)
plot(ms, sub/1e9, strcat(markers{3},'-'), 'LineWidth', 1.5)
hold off
xlim([ms(1), ms(end)])
xlabel('$m$', 'interpreter', 'latex')
ylabel('Time (s)', 'interpreter', 'latex')
title(sprintf('$l = %d$, $n = %d$', l, n), 'interpreter', 'latex')
% legend('Gaussian', 'SRFT', sprintf('Sparse Sign $\\zeta=%d$', zeta), 'interpreter','latex')
set(gca,'FontSize',22)

%% l = 128
randn = [3.307542e6, 3.9731e7, 7.7275375e7, 1.51876791e8, 2.9854125e8, 6.00435375e8, 1.262003959e9, 3.729515458e9, 7.085255959e9, 1.6247350625e10];
srft = [8.156875e6, 1.3725333e7, 2.5898625e7, 5.0209375e7, 1.25926042e8, 2.20276875e8, 4.34150167e8, 8.41062458e8, 8.463901542e9, 2.3324937584e10];
sub = [960041.0, 1.356125e6, 1.467375e6, 1.584375e6, 1.600334e6, 2.0525458e7, 3.4975417e7, 5.3109667e7, 9.006004875e9, 3.6329219917e10];
l = 128; n = 1000; zeta = 8;
ms = [1024, 2048, 4096, 8192, 16384, 32768, 65536, 131072, 262144, 524288];
%% l = 256
randn = [1.07275e7, 7.5114667e7, 1.43364125e8, 2.86452e8, 5.89052417e8, 1.174685834e9, 2.351786167e9, 6.0640045e9, 1.2641817584e10, 3.6632818625e10];
srft = [8.515e6, 1.8312375e7, 3.3279458e7, 6.6128959e7, 2.39836667e8, 5.16507333e8, 1.006661e9, 2.118712833e9, 1.1649105292e10, 2.6035870083e10];
sub = [1.5529666e6, 2.55225e6, 2.757166e6, 2.91575e6, 9.116042e6, 4.1190583e7, 5.3418042e7, 1.75987917e8, 2.1158212083e10, 7.3111442666e10];
l = 256; n = 1000; zeta = 8;
ms = [1024, 2048, 4096, 8192, 16384, 32768, 65536, 131072, 262144, 524288];
%% l = 512
randn = [4.1047375e7, 1.71255375e8, 2.53016416e8, 5.00801917e8, 1.017911209e9, 2.028414583e9, 4.093862292e9, 8.628549084e9, 2.1831761375e10, 6.301566825e10];
srft = [1.9898625e7, 3.9476417e7, 3.8940375e7, 7.4731458e7, 2.86620625e8, 6.04335875e8, 1.040128875e9, 2.190932041e9, 1.3933453958e10, 3.5263012792e10];
sub = [1.771125e6, 2.8572875e6, 2.8492083e6, 6.094625e6, 5.93125e6, 7.32975e6, 3.4465541e7, 1.22326959e8, 2.02741415e10, 1.0401682675e11];
l = 512; n = 1000; zeta = 8;
ms = [1024, 2048, 4096, 8192, 16384, 32768, 65536, 131072, 262144, 524288];
%%
markers = {'ro','gs','bd','c^','mv','y>','<','p','h','+','*','x'};

subplot(1,3,2)
loglog(ms, randn/1e9, strcat(markers{1},'-'), 'LineWidth', 1.5)
hold on
plot(ms, srft/1e9, strcat(markers{2},'-'), 'LineWidth', 1.5)
plot(ms, sub/1e9, strcat(markers{3},'-'), 'LineWidth', 1.5)
hold off
xlim([ms(1), ms(end)])
xlabel('$m$', 'interpreter', 'latex')
ylabel('Time (s)', 'interpreter', 'latex')
title(sprintf('$l = %d$, $n = %d$', l, n), 'interpreter', 'latex')
% legend('Gaussian', 'SRFT', sprintf('Sparse Sign $\\zeta=%d$', zeta), 'interpreter','latex')
set(gca,'FontSize',22)

%% l = 1024
randn = [1.16144375e8, 2.17912917e8, 4.89551667e8, 9.01778917e8, 1.82068425e9, 3.617349625e9, 7.631309083e9, 1.670810125e10, 3.8061715542e10, 9.6225905666e10];
srft = [3.8884375e7, 5.371075e7, 6.1088541e7, 1.02822292e8, 3.26690167e8, 5.96409125e8, 1.141841709e9, 5.636427875e9, 1.3214179833e10, 3.438749425e10];
sub = [1.1798625e7, 1.2018875e7, 1.2724833e7, 1.2542833e7, 1.2882542e7, 2.7565458e7, 5.1444e7, 8.6887292e7, 1.07394345e10, 1.58202522375e11];
l = 1024; n = 1000; zeta = 8;
ms = [1024, 2048, 4096, 8192, 16384, 32768, 65536, 131072, 262144, 524288];
%%
markers = {'ro','gs','bd','c^','mv','y>','<','p','h','+','*','x'};

subplot(1,3,3)
loglog(ms, randn/1e9, strcat(markers{1},'-'), 'LineWidth', 1.5)
hold on
plot(ms, srft/1e9, strcat(markers{2},'-'), 'LineWidth', 1.5)
plot(ms, sub/1e9, strcat(markers{3},'-'), 'LineWidth', 1.5)
hold off
xlim([ms(1), ms(end)])
xlabel('$m$', 'interpreter', 'latex')
ylabel('Time (s)', 'interpreter', 'latex')
title(sprintf('$l = %d$, $n = %d$', l, n), 'interpreter', 'latex')
% legend('Gaussian', 'SRFT', sprintf('Sparse Sign $\\zeta=%d$', zeta), 'interpreter','latex')
set(gca,'FontSize',22)

%%